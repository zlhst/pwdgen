<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>pwd</title>
    <meta http-equiv="Permissions-Policy" content="interest-cohort=()">
    <style id="custom-theme">
      body {
        font-family: Consolas, monaco, monospace;
        font-size: 1.8em;
        color: #AFB3AF;
        background-color: #2C3333;
      }
      td {
        border: 2px dotted #2f6a32;
        border-radius: 14px;
        padding: 8px;
        font-size: 0.8em;
      }
      .generate-button2 {
        font-size: 0.6em;
        color: #1d1d1b;
        background-color: #b3b3b3;
        width: 115px;
        padding: 8px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.3s, color 0.3s;
      }
      .generate-button2:hover {
        background-color: #999999;
        color: #1d1d1b;
      }
      .copied {
        background-color: #2f6a32 !important;
        color: white !important;
      }
    </style>
  </head>
  <body>
    <br>
    <div class="content-to-copy" id="pwd-gen">
      <table>
        <tbody>
          <tr>
            <td id="pwd-gen-result">Create password</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div style="margin-bottom: 40px;margin-top: 10px;" class="form-group row what-to-do">
      <div class="col-md-12">
        <button onclick="window.location.href=window.location.href" type="button" class="generate-button2" id="refresh-button01">Refresh</button>
        <input onclick="CopyToClipboard('pwd-gen-result'); MsgWait(); return false;" class="generate-button2" id="copy-button01" value="Copy" type="button">
      </div>
    </div>

    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const styleParam = urlParams.get('style');

      const themes = {
        "1": { bg: "#1A1A1B", txt: "#D7DADC", accent: "#FF4500", btn: "#FFFFFF" },
        "2": { bg: "#002B36", txt: "#839496", accent: "#2AA198", btn: "#93A1A1" },
        "3": { bg: "#282A36", txt: "#F8F8F2", accent: "#BD93F9", btn: "#6272A4" },
        "4": { bg: "#0F111A", txt: "#8F93A2", accent: "#80CBC4", btn: "#717CB4" },
        "5": { bg: "#2B213A", txt: "#E5E5E5", accent: "#FF5E81", btn: "#BD93F9" },
        "6": { bg: "#1E1E1E", txt: "#D4D4D4", accent: "#4FC1FF", btn: "#CCCCCC" },
        "7": { bg: "#FDF6E3", txt: "#657B83", accent: "#B58900", btn: "#EEE8D5" },
        "8": { bg: "#000000", txt: "#FFFFFF", accent: "#00FF00", btn: "#333333" },
        "9": { bg: "#212121", txt: "#EEFFFF", accent: "#F07178", btn: "#B0BEC5" },
        "10": { bg: "#111111", txt: "#E0E0E0", accent: "#E91E63", btn: "#9E9E9E" },
        "11": { bg: "#263238", txt: "#ECEFF1", accent: "#FFB300", btn: "#546E7A" },
        "12": { bg: "#3C3F41", txt: "#BBBBBB", accent: "#A9B7C6", btn: "#4B4D4D" },
        "13": { bg: "#2D2D2D", txt: "#CCCCCC", accent: "#F92672", btn: "#66D9EF" },
        "14": { bg: "#0D1B2A", txt: "#FFFFFF", accent: "#00E5FF", btn: "#E0E1DD" },
        "15": { bg: "#2C3E50", txt: "#ECF0F1", accent: "#E74C3C", btn: "#BDC3C7" },
        "16": { bg: "#1D1D1B", txt: "#B3B3B3", accent: "#2F6A32", btn: "#808080" }
      };

      if (styleParam && themes[styleParam]) {
        const theme = themes[styleParam];
        const styleSheet = document.getElementById('custom-theme');
        styleSheet.innerHTML = `
          body { font-family: Consolas, monaco, monospace; font-size: 1.8em; color: ${theme.txt}; background-color: ${theme.bg}; }
          td { border: 3px dotted ${theme.accent}; border-radius: 14px; padding: 12px; font-size: 0.8em; color: ${theme.txt}; }
          .generate-button2 { font-size: 0.6em; color: #1d1d1b; background-color: ${theme.btn}; width: 115px; padding: 8px; border: none; border-radius: 8px; cursor: pointer; }
          .copied { background-color: ${theme.accent} !important; color: white !important; }
        `;
      }

      const wishlistLower = 'abcdefghjkmnprstuwxyz';
      const wishlistHigher = 'ACDEFGHJKLMNPQRTUVWXYZ';
      const wishlistDigits = '123456789';
      const wishlistFull = wishlistLower + wishlistHigher + wishlistDigits;

      var generatePassword = (length, wishlist = wishlistFull) =>
        Array.from(crypto.getRandomValues(new Uint32Array(length)))
          .map((x) => wishlist[x % wishlist.length])
          .join('');

      var generatePasswordDigit = (length = 2, wishlist = wishlistDigits) =>
        Array.from(crypto.getRandomValues(new Uint32Array(length)))
          .map((x) => wishlist[x % wishlist.length])
          .join('');

      var generatePasswordLower = (length = 1, wishlist = wishlistLower) =>
        Array.from(crypto.getRandomValues(new Uint32Array(length)))
          .map((x) => wishlist[x % wishlist.length])
          .join('');

      var generatePasswordHigher = (length = 1, wishlist = wishlistHigher) =>
        Array.from(crypto.getRandomValues(new Uint32Array(length)))
          .map((x) => wishlist[x % wishlist.length])
          .join('');

      let pLength = parseInt(urlParams.get('length'));
      if (isNaN(pLength) || pLength < 6) pLength = 12;
      if (pLength > 1024) pLength = 1024;

      var new_var = generatePassword(pLength);
      var pwd_digits = generatePasswordDigit();
      var parts = new_var.match(/.{1,6}/g);
      var new_pwd_value = parts.join("-");
      var final_pwd = new_pwd_value + "-" + generatePasswordLower() + generatePasswordHigher() + pwd_digits;

      document.getElementById("pwd-gen-result").innerText = final_pwd.trim();

      function CopyToClipboard(id) {
        var text = document.getElementById(id).innerText.trim();
        var dummy = document.createElement("textarea");
        document.body.appendChild(dummy);
        dummy.value = text;
        dummy.select();
        document.execCommand("copy");
        document.body.removeChild(dummy);
      }

      const delay = (ms) => new Promise((res) => setTimeout(res, ms));

      const MsgWait = async () => {
        const copyButton = document.getElementById("copy-button01");
        const originalVal = copyButton.value;
        copyButton.value = "Copied";
        copyButton.classList.add("copied");
        await delay(950);
        copyButton.value = originalVal;
        copyButton.classList.remove("copied");
      };
    </script>
  </body>
</html>
